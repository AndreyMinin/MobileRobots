#Макет системы управления карта

Является ROS пакетом
Использует модель карта в симуляторе GAZEBO (www.gazebosim.org)

##Включает в себя следующие пакеты

**cart_launch** - проект с описанием сцены для Gazebo с картом и объектами сцены

**polaris_ranger_ev** - проект, содержащий модель карта с датчиками
model/simple_cart.sdf - карт без датчиков,
model/scan_cart.sdf - карт с плоским дальномером и камерой

**vehicle_ros_plugin** - плагин для Gazebo, позволяющий управлять моделью из ROS.
* robot/velocity - топик для задания скорости движения
* robot/steering - топик для задания кривизны траектории (поворот руля)
* robot/odom   -   топик с текущими данными одометрии от робота


**simple_controller** - простейший ROS контроллер, управляющий движением карта по овальной траектории, с помощью пид регулятора, в качестве ошибки используется расстояние от траектории, вычисляемое на основе абсолютного положения робота. Контроллер эмулирует работу системы управления рулением AGI. Модуль управляет поворотом руля карта

**velocity_controller** - модуль для управления скоростью карта на основе данных датчиков и будущей траектории

**odo2tf** - модуль преобразования данных о реальном положении модели робота (Odometry) в сообщения tf для формирования преобразования систем координат world->base_link
Пописывается на топики:
* /odo - топик с данными одометрии ([nav_msgs/Odometry])
Публикует преобразование tf

**laser2d_map** - модуль построения карты препятствий по данным сканирующего двумерного дальномера
Подписывается на топик
* /laser_scan - данные сканирующего дальномера (sensor_msgs/LaserScan)
* /tf - преобразование СК от лазера до world
Публикует
* laser_map - карта препятствий в системе координат world

Установка
Необходимо, чтобы были установлены ROS (Kinetic) и Gazebo (версия 8)

1. Создать рабочую папку

	$ mkdir ros_ws
	$ mkdir ros_ws/src

 проинициализировать рабочую папку ROS

	$ cd ros_ws
	$ catkin_init_workspace src

2 склонировать проект в папку src

	$ cd src
	$ git clone ...

3 собрать проекты

	$ cd ..
	$ catkin_make

или воспользоваться скриптом **build.sh**

	$ ./build.sh

Если сборка прошла без ошибок можно переходить к запуску

Для первого запуска может потребоваться выход в интернет- чтобы закачать некторые модели с репозитария Gazebo
4 запуск
  команды выполняются из директории рабочей области (ros_ws)
инициализация рабочей области ROS

	$ source devel/setup.bash

б) запуск модели и контроллера

	$ roslaunch simple_controller controller.launch

модель стартует, затем запускаетя интерфейс gzclient, rviz и rqt

В rqt в плагине publish можно отправить сообщение с заданной скоростью в топик /robot/velocity

  Должно появиться окно GAZEBO, в котором карт ездит в некоторой сцене, отрабатывая заданную траекторию
  г) управление скоростью можно осуществлять с помощью rqt (publish_message) публикуя сообщение со значением скорости в топик /robot/velocity

  Также можно осуществить запуск с помощью скрипта start.sh, находящегося в папке src

	$ ./start.sh




